// Managed by IAC. Do not edit this file directly.
{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "commitMessageLowerCase": "never", // Ensures sentence case commit messages to comply with commitlint rules
  "extends": [
    "helpers:pinGitHubActionDigests",
    "security:only-security-updates"
  ],
  // the manager module looks for files and extracts their dependencies
  "enabledManagers": [
    "github-actions",
    "terraform",
    "tflint-plugin"
  ],
  "github-actions": {
    "enabled": true,
    "commitMessagePrefix": "ci(gha): ",
    "ignorePaths": [
      ".trunk/**" // Ignore any updates for the trunk setup-ci action
    ]
  },
  "tflint-plugin": {
    "enabled": true,
    "commitMessagePrefix": "feat(tflint): ",
    "commitMessageTopic": "{{depName}}",
    "fileMatch": [
      // match all .tflint_ci.hcl and .tflint_trunk.hcl files
      // 'ci' and 'trunk' have different configurations
      "\\.tflint_(ci|trunk)\\.hcl$"
    ]
  },
  "packageRules": [
    {
      // Major updates must be approved on the dependency dashboard
      "matchUpdateTypes": [
        "major"
      ],
      "dependencyDashboardApproval": true
    },
    {
      // datasources look up dependency versions from a registry
      "matchDatasources": [
        "terraform-provider"
      ],
      // must be explicitly enabled due to security preset disabling all packageRules
      "enabled": true,
      // we want to look up dependencies from the OpenTofu registry
      "registryUrls": [
        "https://registry.opentofu.org"
      ],
      "addLabels": [
        "tf:update"
      ],
      "commitMessagePrefix": "feat(iac): ",
      "commitMessageTopic": "{{depName}} provider",
      // terraform-provider datasource has release timestamp support
      "minimumReleaseAge": "3 days",
      // bump required because v6.6.0, for example, satisfies the range "~> 6.5"
      "rangeStrategy": "bump"
    },
    {
      "matchDatasources": [
        "github-releases" // data source for the tflint-plugin manager and tofu required_version
      ],
      "enabled": true,
      "minimumReleaseAge": "3 days"
    },
    {
      "matchDatasources": [
        "github-tags" // data source for github-actions
      ],
      "enabled": true
    }
  ],
  "vulnerabilityAlerts": {
    "addLabels": [
      "security"
    ],
    "commitMessagePrefix": "fix(deps): ",
    "rangeStrategy": "auto"
  }
}